(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?a.credentials="include":e.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(e){if(e.ep)return;e.ep=!0;const a=n(e);fetch(e.href,a)}})();function X(){let o=0,t=0,n=0,l=0,e=0,a=0,s=0,d=0,r=0,c=0,f=0,g=0;return document.querySelectorAll(".route__row select").forEach(E=>{const w=E.closest(".route"),_=E.options[E.selectedIndex],S=w.querySelector(".distance"),p=parseFloat(S.value)||0,u=_.getAttribute("data-value");u&&(u==="signal"?o+=p:u==="point"?t+=p:u==="familiarization"?n+=p:u==="patrol"?l+=p:u==="breaks"?e+=p:u==="pickupH"?a+=p:u==="pickupV"?s+=p:u==="wash"?d+=p:u==="service"?r+=p:u==="check"?c+=p:u==="change"?f+=p:u==="other"&&(g+=p))}),{signal:o,point:t,familiarization:n,patrol:l,breaks:e,pickupH:a,pickupV:s,wash:d,service:r,check:c,change:f,other:g}}function ee(){let o=0,t=0;return document.querySelectorAll(".route__row select").forEach(n=>{const l=n.options[n.selectedIndex];if(l){const e=l.getAttribute("data-valuewhose");e&&(e==="signalHolding"?o+=1:e==="signalVenbest"&&(t+=1))}}),{signalHolding:o,signalVenbest:t}}async function te(o){const t=document.getElementById("dataLoad");let n={};if(!localStorage.initData||!localStorage.initData.city){t&&(t.innerHTML="",t.textContent="Формую дані");try{t&&(t.innerHTML="",t.textContent="Формую запит");const l=await fetch(o);if(!l.ok)throw new Error("Ошибка сети");const e=await l.json();if(!e||typeof e!="object")return;if(employee.innerHTML="",await T("Формую перелік співробітників",()=>{e.columnB&&(n.employee=e.columnB,e.columnB.forEach(a=>{let s=document.createElement("option");s.value=a,employee.appendChild(s)}))}),await T("Формую перелік автівок",()=>{e.columnC&&(n.cars=e.columnC,e.columnC.forEach(a=>{let s=document.createElement("option");s.value=a,cars.appendChild(s)}))}),await T("Формую перелік нарядів",()=>{if(e.columnD){n.units=e.columnD;let a=document.getElementById("unit");a.querySelectorAll("option").forEach((d,r)=>{r>0&&d.remove()}),e.columnD.forEach(d=>{let r=document.createElement("option");r.value=d,r.textContent=d,a.appendChild(r)})}}),e.city=o,localStorage.setItem("initData",JSON.stringify(e)),localStorage.getItem("formData")){const a=JSON.parse(localStorage.getItem("formData"));document.getElementById("unit").value=a.unit||""}V()}catch(l){V(),console.error("Ошибка:",l)}}else V()}async function T(o,t){const n=document.getElementById("dataLoad");n&&(n.textContent="",n.classList.add("hide"),await new Promise(l=>setTimeout(l,150)),n.textContent=o,n.classList.remove("hide")),await new Promise(l=>setTimeout(l,500)),t()}function V(){const o=document.getElementById("load");o&&setTimeout(()=>{o.classList.add("finish")},1e3)}function oe(){document.addEventListener("change",o=>{if(o.target.matches("select")){const t=o.target,n=t.options[t.selectedIndex],l=n.dataset.toggle;if(l){const e=document.getElementById(l);if(e&&n.dataset.value==="signal")e.classList.add("active"),e.closest(".route").classList.add("signal");else if(e&&n.dataset.value!=="signal"){e.classList.remove("active");const a=e.closest(".route");a.classList.remove("signal");const s=a.querySelector(".isCombat__box "),d=a.querySelector(".arrested");d.querySelectorAll("input").forEach(c=>{c.value=0}),s.classList.remove("combat"),d.classList.add("dn"),a.classList.remove("combat")}}}})}function ne(){localStorage.getItem("formData")&&JSON.parse(localStorage.getItem("formData"))}ne();const ae=document.querySelector(".hardReload"),M=document.querySelector(".moadHarReload"),se=document.getElementById("hardResetCansel"),le=document.getElementById("hardResetReset");ae.addEventListener("click",()=>{M.classList.remove("dn")});se.addEventListener("click",()=>{M.classList.contains("dn")||M.classList.add("dn")});le.addEventListener("click",()=>{Y()});const N=document.getElementById("load");N&&setTimeout(()=>{N.classList.add("finish")},1e3);const de="https://script.google.com/macros/s/AKfycbzYmRjVAs3-xWVgOVu05Pl0ag45-kR2AEJ09jE43ZVTQMPNOH8z5g2Cmd8Bo0xK1xFy/exec",ie="https://script.google.com/macros/s/AKfycbzGnEK-gtVVojssszrzHxHCeO0q6Lu6oXDsk-CCKKlfpqjA6XeSQrZHHeAyclZdYAcSkA/exec",re="https://script.google.com/macros/s/AKfycby27hfmv5uhWfQIpdbLcDFo6qCH7pVZAEp4Aogv_j-SRY155_kWlFp3iVRALev_tsoR/exec";let b;const ce=document.getElementById("employee"),ue=document.getElementById("cars");document.getElementById("unit");const q=document.getElementById("routeCard");let i=0;const me=document.getElementById("routesContainer"),ge=document.querySelector(".forward"),pe=document.querySelector(".modal__save");let F;const ve=document.getElementById("resulBtn"),ye=document.getElementById("results"),fe=document.getElementById("searchCardErrore"),B=document.getElementById("spinner"),O=document.getElementById("searchCardErroreText");if(localStorage.getItem("initData")){let o=JSON.parse(localStorage.getItem("initData"));console.log(o),b=o.city}ve.addEventListener("click",()=>{ye.classList.toggle("active")});function j(o){const[t,n]=o.split(":").map(Number);return t*60+n}function K(){F=document.querySelectorAll(".route__title"),F.forEach(o=>{o.removeEventListener("click",J)}),F.forEach(o=>{o.addEventListener("click",J)})}oe();function J(o){const t=o.currentTarget,n=t.dataset.toggle,l=document.getElementById(n);l&&(l.classList.toggle("active"),t.classList.toggle("active"))}function L(){const o={date:document.getElementById("date").value,unit:document.getElementById("unit").value,driver:document.getElementById("driver").value,senior:document.getElementById("senior").value,car:document.getElementById("car").value,startOdometer:document.getElementById("startOdometer").value,routes:[],signalsHolding:document.getElementById("signalsHolding").value,signalsVenbest:document.getElementById("signalsVenbest").value,extendedOdometr:[],signalHolding:0,signalVenbest:0,signalsDop:document.getElementById("signalsDop").value,totalTransferred:0,totalDelayed:0};o.routes=[],o.extendedOdometr=[],document.querySelectorAll("#routesContainer .route").forEach(a=>{const s=a.querySelectorAll(".input"),d=a.querySelector(".isCombat__box");let r=(d==null?void 0:d.classList.contains("combat"))||!1;const c={from:s[0].value,departureTime:s[1].value,to:s[2].value,arrivalTime:s[3].value,distance:parseFloat(s[4].value)||"",purpose:s[5].value,delayed:s[6].value||0,transferred:s[7].value||0,message:s[8].value,isCombat:r};o.routes.some(g=>g.from===c.from&&g.departureTime===c.departureTime&&g.to===c.to&&g.arrivalTime===c.arrivalTime&&g.distance===c.distance&&g.purpose===c.purpose)||o.routes.push(c)});const t=X(),n=ee();o.signalHolding=n.signalHolding,o.signalVenbest=n.signalVenbest,o.extendedOdometr=[{signal:t.signal||0,point:t.point||0,familiarization:t.familiarization||0,patrol:t.patrol||0,breaks:t.breaks||0,pickupH:t.pickupH||0,pickupV:t.pickupV||0,wash:t.wash||0,service:t.service||0,check:t.check||0,change:t.change||0,other:t.other||0}];let l=0;o.routes.forEach(a=>{l+=parseFloat(a.transferred)||0});let e=0;o.routes.forEach(a=>{e+=parseFloat(a.delayed)||0}),o.totalTransferred=l,o.totalDelayed=e,document.getElementById("signal").textContent=t.signal,document.getElementById("point").textContent=t.point,document.getElementById("familiarization").textContent=t.familiarization,document.getElementById("patrol").textContent=t.patrol,document.getElementById("breaks").textContent=t.breaks,document.getElementById("pickupH").textContent=t.pickupH,document.getElementById("pickupV").textContent=t.pickupV,document.getElementById("wash").textContent=t.wash,document.getElementById("service").textContent=t.service,document.getElementById("check").textContent=t.check,document.getElementById("change").textContent=t.change,document.getElementById("other").textContent=t.other,document.getElementById("totalH").textContent=o.signalHolding,document.getElementById("totalV").textContent=o.signalVenbest,document.getElementById("signalsHolding").value=o.signalHolding,document.getElementById("signalsVenbest").value=o.signalVenbest,document.getElementById("totalD").textContent=o.signalsDop,document.getElementById("totalArest").textContent=o.totalDelayed,document.getElementById("totalTransferred").textContent=o.totalTransferred,localStorage.setItem("formData",JSON.stringify(o)),A()}ge.addEventListener("click",()=>{pe.classList.add("dn")});function W(){const o=localStorage.getItem("initData");if(o){const n=JSON.parse(o);if(n.columnB&&n.columnB.forEach(l=>{let e=document.createElement("option");e.value=l,ce.appendChild(e)}),n.columnC&&n.columnC.forEach(l=>{let e=document.createElement("option");e.value=l,ue.appendChild(e)}),n.columnD){let l=document.getElementById("unit");l.querySelectorAll("option").forEach((a,s)=>{s>0&&a.remove()}),n.columnD.forEach(a=>{let s=document.createElement("option");s.value=a,s.textContent=a,l.appendChild(s)})}}const t=localStorage.getItem("formData");if(t){const n=JSON.parse(t);console.log("-------",n,"-------"),document.getElementById("date").value=n.date||"",document.getElementById("unit").value=n.unit||"",document.getElementById("driver").value=n.driver||"",document.getElementById("senior").value=n.senior||"",document.getElementById("car").value=n.car||"",document.getElementById("startOdometer").value=n.startOdometer||"",document.getElementById("signalsVenbest").value=n.signalsVenbest||"",document.getElementById("signalsHolding").value=n.signalsHolding||"",document.getElementById("signalsHolding").value=n.signalHolding,document.getElementById("signalsVenbest").value=n.signalVenbest,document.getElementById("signalsDop").value=n.signalsDop,document.getElementById("totalD").textContent=n.signalsDop,document.getElementById("totalH").textContent=n.signalHolding,document.getElementById("totalV").textContent=n.signalVenbest,document.getElementById("totalArest").textContent=n.totalDelayed,document.getElementById("totalTransferred").textContent=n.totalTransferred,document.getElementById("signal").textContent=n.extendedOdometr[0].signal,document.getElementById("point").textContent=n.extendedOdometr[0].point,document.getElementById("familiarization").textContent=n.extendedOdometr[0].familiarization,document.getElementById("patrol").textContent=n.extendedOdometr[0].patrol,document.getElementById("breaks").textContent=n.extendedOdometr[0].breaks,document.getElementById("pickupH").textContent=n.extendedOdometr[0].pickupH,document.getElementById("pickupV").textContent=n.extendedOdometr[0].pickupV,document.getElementById("wash").textContent=n.extendedOdometr[0].wash,document.getElementById("service").textContent=n.extendedOdometr[0].service,document.getElementById("check").textContent=n.extendedOdometr[0].check,document.getElementById("change").textContent=n.extendedOdometr[0].change,document.getElementById("other").textContent=n.extendedOdometr[0].other,i=n.routes.length;const l=document.getElementById("routesContainer");l.innerHTML="",n.routes.forEach((e,a)=>{const s=document.createElement("div");s.classList.add("route"),e.purpose==="Спрацювання"&&s.classList.add("signal"),e.isCombat&&s.classList.add("combat"),s.setAttribute("data-id",`box${a+1}`),s.innerHTML=`
            <div class="route__title" data-toggle="box${a+1}">
            <h2>Поїздка <span>${a+1}</span> </h2>
            <div class="route__hide">Згорнути</div>

            </div>
            <div class="route__row-box "  id="box${a+1}">
            <div>
                <div class="hide__box">

                    <div class="route__row streetRow">
                        <input class="input req suggestions"  type="text" placeholder="Звідки" id="from${a+1}" required="" value="${e.from}">
                        <input class="input req" type="time" required="" value="${e.departureTime}">
                    </div>
                    <div class="route__row streetRow">
                        <input class="input req suggestions" type="text" placeholder="Куди" id="to${a+1}" required="" value="${e.to}">
                        <input class="input req" type="time" required="" value="${e.arrivalTime}">
                    </div>
                    <div class="route__row last" id="last">
                        <input class="input distance req" type="number"  placeholder="Відстань(км)" required=""
                        value="${e.distance}">

                           <select class="input req" id="target${a+1}" required>
                    <option data-toggle="arest${a+1}" value="" selected>                    мета поїздки</option>
                    
                    <option data-toggle="arest${a+1}" data-value="signal" data-valuewhose="signalHolding" value="Спрацювання ОХ">Спрацювання ОХ</option>

                    <option data-toggle="arest${a+1}" data-value="signal" data-valuewhose="signalVenbest" value="Спрацювання Партн.">Спрацювання Партн.</option>
                    <option data-toggle="arest${a+1}"  data-value="point" value="Точка відстою">Точка відстою</option>
                    <option data-toggle="arest${a+1}" data-value="familiarization" value="Ознайомлення">Ознайомлення</option>
                    <option data-toggle="arest${a+1}" data-value="patrol" value="Патруль">Патруль</option>
                    <option data-toggle="arest${a+1}" data-value="breaks" value="Туалет/Обід">Туалет/Обід</option>
                    <option data-toggle="arest${a+1}" data-value="pickupH" value="Підвіз ОХ">Підвіз ОХ</option>
                    <option data-toggle="arest${a+1}" data-value="pickupV" value="Підвіз Партн.">Підвіз Партн.</option>
                    <option data-toggle="arest${a+1}" data-value="wash" value="Мийка">Мийка</option>
                    <option data-toggle="arest${a+1}" data-value="service" value="СТО">СТО</option>                    
                    <option data-toggle="arest${a+1}" data-value="check" value="Перевірка">Перевірка</option>                    
                    <option data-toggle="arest${a+1}" data-value="change" value="Перезмінка">Перезмінка</option>                    
                    <option data-toggle="arest${a+1}" data-value="other" value="Інше">Інше</option>
                  </select>
                  
                      
                        </div>


  <div class="isCombat ${e.purpose.includes("Спрацювання")?"active":""}"" id="arest${a+1}">
  <div class="isCombat__overflow">
    <span>Бойова??</span>
    <div class="isCombat__box ${e.isCombat?"combat":""}"></div>
  </div>
  </div>

                          <div class="arrested ${e.isCombat?"":"dn"}"  >


<div class="overflow">

                  <div class="arrested__row">
                    <span>Затримано</span>
                    <input class="input req" value="${e.delayed}" type="number" id="arest">
                  </div>
                  <div class="arrested__row">
                    <span>передано до полиції</span>
                    <input class="input req" value="${e.transferred}" type="number" >
                  </div>
 </div>

                </div>



                        <div class="route__row">
                        <textarea  class="input"  placeholder="Примітки..." id="message" cols="20" rows="5"> ${e.message}</textarea>
                    </div>
            
                    <button type="button" class="deleteRoute">Видалити</button>
                </div>

            </div>
        </div>
            `;const d=s.querySelector(`#target${a+1}`);if(d){const r=d.options;for(let c=0;c<r.length;c++)if(r[c].value.trim()===e.purpose.trim()){r[c].selected=!0,e.purpose.includes("Спрацювання")&&s.classList.add("signal");break}}l.appendChild(s)})}K(),I(),R()}window.addEventListener("DOMContentLoaded",W);function A(){const o=parseFloat(document.getElementById("signalsHolding").value)||0,t=parseFloat(document.getElementById("signalsVenbest").value)||0,n=parseFloat(document.getElementById("signalsDop").value)||0;let l=o+t+n;document.getElementById("totalSignals").textContent=l}function I(){const o=parseFloat(document.getElementById("startOdometer").value)||0;let t=0;document.querySelectorAll("#routesContainer .route input.distance").forEach(l=>{t+=parseFloat(l.value)||0}),document.getElementById("dailyMileage").textContent=t,document.getElementById("dailyKm").textContent=t+" км";const n=o+t;document.getElementById("endOdometerValue").textContent=n.toFixed(1),document.getElementById("endOd").textContent=n.toFixed(1)+" км",document.getElementById("signalsHolding").addEventListener("input",A),document.getElementById("signalsVenbest").addEventListener("input",A),A()}function Ee(){document.getElementById("startOdometer").addEventListener("input",I),document.getElementById("routesContainer").addEventListener("input",o=>{o.target.classList.contains("distance")&&I()}),document.getElementById("addRoute").addEventListener("click",()=>{i++;const o=document.getElementById("routesContainer"),t=document.createElement("div");if(t.classList.add("route"),t.setAttribute("data-id",`box${i}`),t.innerHTML=`
        <div class="route__title" data-toggle="box${i}">
        <h2>Поїздка <span>${i}</span> </h2>
        <div class="route__hide">ЗГОРНУТИ</div>

        </div>
        <div class="route__row-box active" id="box${i}">
        <div>
            <div class="hide__box">

                <div class="route__row streetRow">
                    <input class="input req suggestions" type="text" placeholder="Звідки" id="from${i}" required="" value="">
                    <input class="input req" type="time" required="" value="">
                </div>
                <div class="route__row streetRow">
                    <input class="input req suggestions" type="text" placeholder="куди" id="to${i}"  required="" value="">
                    <input class="input req" type="time" required="" value="">
                </div>
                <div class="route__row last" id="last">
                    <input class="input distance req" type="number" placeholder="Відстань(км)" required=""
                    value="">
              
                            <select class="input req" id="target" required>
                    <option data-toggle="arest${i}" value="" selected>Мета поїздки</option>
                    <option data-toggle="arest${i}" data-value="signal" value="Спрацювання ОХ" data-valuewhose="signalHolding">Спрацювання ОХ</option>
                    <option data-toggle="arest${i}" data-value="signal" value="Спрацювання Партн." data-valuewhose="signalVenbest">Спрацювання Партн.</option>
                    <option data-toggle="arest${i}" data-value="point" value="Точка відстою">Точка відстою</option>
                    <option data-toggle="arest${i}" data-value="familiarization" value="Ознайомлення">Ознайомлення</option>
                    <option data-toggle="arest${i}" data-value="patrol" value="Патруль">Патруль</option>
                    <option data-toggle="arest${i}" data-value="breaks" value="Туалет/Обід">Туалет/Обід</option>
                    <option data-toggle="arest${i}" data-value="pickupH" value="Підвіз ОХ">Підвіз ОХ</option>
                    <option data-toggle="arest${i}" data-value="pickupV" value="Підвіз Партн.">Підвіз Партн.</option>
                    <option data-toggle="arest${i}" data-value="wash" value="Мийка">Мийка</option>
                    <option data-toggle="arest${i}" data-value="service" value="СТО">СТО</option>
                    <option data-toggle="arest${i}" data-value="check" value="Перевірка">Перевірка</option>
                    
                    <option data-toggle="arest${i}" data-value="change" value="Перезмінка">Перезмінка</option>
                    
                    
                    
                    
                    <option data-toggle="arest${i}" data-value="other" value="Інше">Інше</option>
                  </select>
              
                </div>

                  <div class="isCombat" id="arest${i}">
                    <div class="isCombat__overflow">
                      <span>Бойова?</span>
                      <div class="isCombat__box"></div>
                    </div>
                  </div>

                 <div class="arrested dn" >
  <div class="overflow">
                  <div class="arrested__row">
                    <span>Затримано</span>
                    <input class="input req"  placeholder="Затримано" value="0" type="number" id="arest">
                  </div>
                  <div class="arrested__row">
                    <span>передано до полиції</span>
                    <input class="input req"  value="0" type="number" id="police">
                  </div>
    </div>

                </div>
                <div class="route__row">
                                    <textarea class="input"  placeholder="Примітки..." id="message" cols="20" rows="5"></textarea>
                                </div>
                                <button type="button" class="deleteRoute">Видалити</button>
            </div>

        </div>
    </div>
        `,o.appendChild(t),i>1){let n=document.getElementById(`to${i-1}`).value,l=document.getElementById(`from${i}`);l.value=`${n}`}I(),K(),R()})}async function he(o){const t=document.createElement("div");t.className="modal__sendForm";const n=document.createElement("div");n.className="logo";const l=document.createElement("img");l.src="/public/logo.svg",l.alt="",n.appendChild(l);const e=document.createElement("div");e.className="modal__message";const a=document.createElement("div");a.className="box";const s=v=>{const m=document.createElement("div");return m.className="loading loading07",v.forEach(h=>{const C=document.createElement("span");C.setAttribute("data-text",h),C.textContent=h,m.appendChild(C)}),m},d=s(["В","І","Д","П","Р","А","В","Л","Я","Ю"]),r=s(["Д","А","Н","І"]);a.appendChild(d),a.appendChild(r),e.appendChild(a);const c=document.createElement("div");c.className="lastBtn",c.textContent="Оновити";const f=document.createElement("div");f.className="erBox";const g=document.createElement("div");g.className="support",g.classList.add("er-bnt"),g.textContent="Підтримка",g.addEventListener("click",()=>{location.reload()}),t.appendChild(n),t.appendChild(e),t.appendChild(c),t.appendChild(f),f.appendChild(g),document.body.appendChild(t);let E=0,w=Number(document.getElementById("signalsHolding").value),_=Number(document.getElementById("signalsVenbest").value),S=Number(document.getElementById("signalsDop").value),p=w+_+S;const u={date:document.getElementById("date").value,unit:document.getElementById("unit").value,driver:document.getElementById("driver").value,senior:document.getElementById("senior").value,signalsHolding:w,signalsVenbest:_,signalsDop:S,signalsCombat:E,totalSignal:p,car:document.getElementById("car").value,totalArest:parseFloat(document.getElementById("totalArest").textContent)||0,totalTransferred:parseFloat(document.getElementById("totalTransferred").textContent)||0,startOdometer:Math.round(parseFloat(document.getElementById("startOdometer").value)||0),routes:[],endOdometer:Math.round(parseFloat(document.getElementById("endOdometerValue").textContent)||0),signalOdometer:Math.round(parseFloat(document.getElementById("signal").textContent)||0),pointOdometer:Math.round(parseFloat(document.getElementById("point").textContent)||0),familiarizationOdometer:Math.round(parseFloat(document.getElementById("familiarization").textContent)||0),patrolOdometer:Math.round(parseFloat(document.getElementById("patrol").textContent)||0),breaksOdometer:Math.round(parseFloat(document.getElementById("breaks").textContent)||0),pickupHOdometer:Math.round(parseFloat(document.getElementById("pickupH").textContent)||0),pickupVOdometer:Math.round(parseFloat(document.getElementById("pickupV").textContent)||0),washOdometer:Math.round(parseFloat(document.getElementById("wash").textContent)||0),serviceOdometer:Math.round(parseFloat(document.getElementById("service").textContent)||0),checkOdometer:Math.round(parseFloat(document.getElementById("check").textContent)||0),changeOdometer:Math.round(parseFloat(document.getElementById("change").textContent)||0),otherOdometer:Math.round(parseFloat(document.getElementById("other").textContent)||0)};document.querySelectorAll("#routesContainer .route").forEach(v=>{const m=v.querySelectorAll(".input"),h=v.querySelector(".isCombat__box");let C="нет";h&&h.classList.contains("combat")&&(C="да",E++);const k=j(m[3].value),U=j(m[1].value),Q=k-U;u.routes.push({from:m[0].value||"",departureTime:m[1].value||"",to:m[2].value||"",arrivalTime:m[3].value||"",distance:parseFloat(m[4].value)||0||"",purpose:m[5].value||"",arest:m[6].value||"",transferred:m[7].value||"",message:m[8].value||"",isCombat:C,travelTime:Q})}),u.signalsCombat=E;try{const v=document.querySelector(".box"),m=document.querySelector(".lastBtn");let h=o;console.log(u);const k=await(await fetch(`https://morning-lake-0dfa.kiriluka68.workers.dev/?url=${h}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)})).json();k.status==="success"?(v.classList.add("finish"),setTimeout(()=>{v.innerHTML="<p>Дякую, дані успішно відправлені!</p> ",v.classList.remove("finish"),m.classList.add("active"),m.addEventListener("click",Y)},300)):(console.log("ошибка 1"),f.classList.add("active"),v.innerHTML=`<p>Помилка1! <br/> <span> ${k.message}</span></p>`)}catch(v){console.log(v),console.log("ошибка 2"),f.classList.add("active"),a.innerHTML=`<p>Помилка2! <br/> <span>${v}</span></p>`}}function Ce(){Ee()}function Y(){localStorage.clear(),location.reload()}Ce();function R(){document.querySelectorAll("input, select,textarea").forEach(o=>{o.addEventListener("input",L),o.addEventListener("change",L)})}document.addEventListener("click",o=>{let t=o.target;if(t.classList.contains("isCombat__box")){t.classList.toggle("combat");const n=t.closest(".route"),e=n.querySelector(".arrested").querySelectorAll("input");let a=t.closest(".isCombat"),s=a==null?void 0:a.nextElementSibling;n.classList.toggle("combat"),e.forEach(d=>{d.value=0}),s&&s.classList.contains("arrested")&&s.classList.toggle("dn"),L()}});document.getElementById("routesContainer").addEventListener("click",o=>{if(o.target.classList.contains("deleteRoute")){const t=document.querySelector(".modal__delete");let n=o.target.closest(".route");t.classList.remove("dn");const l=document.querySelector(".buttonCancel"),e=document.querySelector(".buttonDelete");l.replaceWith(l.cloneNode(!0)),e.replaceWith(e.cloneNode(!0));const a=document.querySelector(".buttonCancel"),s=document.querySelector(".buttonDelete");a.addEventListener("click",()=>{t.classList.add("dn")}),s.addEventListener("click",()=>{i--,n.remove(),t.classList.add("dn"),I(),L()})}});R();function Be(o){const t={componentRestrictions:{country:"UA"},fields:["address_components","geometry"],types:["address"]},n=new google.maps.places.Autocomplete(o,t);n.addListener("place_changed",function(){const l=n.getPlace();if(l.geometry){let e="",a="";if(l.address_components.forEach(s=>{s.types.includes("route")&&(e=s.long_name),s.types.includes("locality")&&s.long_name,s.types.includes("street_number")&&(a=s.long_name)}),e){let s=e;a&&(s+=`, ${a}`),o.value=s,L()}}})}me.addEventListener("click",o=>{o.target.classList.contains("suggestions")&&Be(o.target)});const be=document.getElementById("buttonSend-Cancel"),Ie=document.getElementById("buttonSend-Send"),Z=document.getElementById("modalSend"),Le=document.querySelector(".btn--send");Le.addEventListener("click",o=>{o.preventDefault();let t=[],n=document.querySelectorAll(".req"),l=document.querySelectorAll(".route");l&&l.forEach(e=>{let a=e.querySelector(".route__title"),s=e.querySelector(".route__row-box");a.classList.remove("active"),s.classList.remove("active")});for(let e of n)if(e.classList.remove("errore"),e.value.trim()===""){e.classList.add("errore");let a=e.closest(".route");if(a){let d=a.querySelector(".route__title"),r=a.querySelector(".route__row-box");d.classList.add("active"),r.classList.add("active")}const s=e.getBoundingClientRect();window.scrollTo({top:window.scrollY+s.top-75,behavior:"smooth"}),t.push(e);break}console.log(t),t.length==0&&Z.classList.remove("dn")});Ie.addEventListener("click",o=>{he(b)});be.addEventListener("click",()=>{Z.classList.add("dn")});const xe=document.querySelector(".tgLink");xe.addEventListener("click",()=>{window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open("https://t.me/Alexandrr32","_system"):window.open("https://t.me/Alexandrr32","_blank")});const we=document.querySelector("#searchCard__value"),_e=document.querySelector("#searchCard__btn");let $=null,D=null;const z=new Headers;z.append("Authorization","Basic YS5raXJpbHVrOm03OTdnTGZaOEo=");z.append("Accept","application/json");_e.addEventListener("click",()=>{const o=document.getElementById("routeRoute"),t=document.getElementById("nameCard"),n=document.getElementById("nameClient"),l=document.getElementById("adressCard");n.textContent="",t.textContent="",l.textContent="";let e=we.value.toUpperCase().replace(/\s+/g,"");O.classList.contains("dn")||O.classList.add("dn"),B.classList.contains("dn")||B.classList.add("dn"),o.classList.remove("active"),q.classList.remove("active");let a="";e!==""&&(a=`https://l-cs.ohholding.com.ua/api/v2/object-card/by-account-number/${e}`,B.classList.remove("dn"),fe.textContent=`${e}`,fetch(a,{method:"GET",headers:z,redirect:"follow"}).then(s=>{if(!s.ok)throw new Error("Network response was not ok");return s.json()}).then(s=>{const d=s.data;if(d.length>0){if(B.classList.add("dn"),console.log(d),console.log(d[0].coordinates.lat),n.textContent=`${d[0].client_name}`,t.textContent=`${d[0].object_title}`,l.textContent=`${d[0].object_address}`,d[0].coordinates.lat){console.log("coordinaty");const r=`https://www.google.com/maps/dir/?api=1&destination=${d[0].coordinates.lat},${d[0].coordinates.lng}`;$&&o.removeEventListener("click",$),$=()=>{window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(r,"_system"):window.open(r,"_blank")},o.classList.add("active"),o.addEventListener("click",$),D&&q.removeEventListener("click",D)}else console.log("coord net");if(d[0].object_card_url!==null){console.log(d[0].object_card_url);let r=`${d[0].object_card_url}`;D=()=>{window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(r,"_system"):window.open(r,"_blank")},q.classList.add("active"),q.addEventListener("click",D)}}else console.log("net"),B.classList.add("dn"),O.classList.remove("dn")}).catch(s=>{console.error("Ошибка:",s),O.classList.remove("dn"),B.classList.add("dn")}))});const G=document.querySelector(".modal__cities");if(localStorage.getItem("initData")){let o=JSON.parse(localStorage.getItem("initData"));o&&o.city&&G.classList.add("dn")}const P=document.querySelectorAll(".modal__cities-item"),x=document.getElementById("selectCityBtn"),H=document.querySelector(".selectedCitySpan");let y;function Se(){x.disabled=!1,x.classList.add("active")}function ke(){x.disabled=!0,x.classList.remove("active"),y=""}P.forEach(o=>{o.addEventListener("click",()=>{o.classList.contains("selected")?(o.classList.remove("selected"),ke(),H.textContent="",console.log(y)):(P.forEach(t=>t.classList.remove("selected")),y=o.getAttribute("data-city"),y=="zp"&&(H.textContent="ЗАПОРІЖЖЯ"),y=="dp"&&(H.textContent="ДНІПРО"),y=="kr"&&(H.textContent="КРИВИЙ РІГ"),o.classList.add("selected"),console.log(y),Se(),document.getElementById("selectCityBtn").scrollIntoView({behavior:"smooth",block:"start"}))})});x.addEventListener("click",()=>{console.log(localStorage.getItem("initData")),y==="zp"?b=de:y==="dp"?b=ie:y==="kr"&&(b=re),G.classList.add("dn"),N.classList.remove("finish"),console.log(y),te(b),W()});
